<!doctype html>
  <meta name="viewport" content="width=device-width,initial-scale=1, minimum-scale=1, user-scalable=no">
<html lang="en">
<head>
  <meta charset="utf-8">

  <title>lilys game</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">

  <link rel="stylesheet" href="css/styles.css?v=1.0">
		<style>
			canvas{			border: 1px solid green;}
		</style>

</head>

<body>



<div id='status'>

</div>
  <canvas id="screen" width="500" height="500" tabindex='1'>

  </canvas>
  <script type="text/javascript">
  ///setting canvas to window height .
 const sound = new Audio()
  var score =0;
  var canvas = document.querySelector('canvas');

  console.log("starts");


  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight ;
  var cW =canvas.width;
  var cH = canvas.height;
  var c = canvas.getContext('2d'); //sets canvs to 2d
  var colorArray = [
    'rgba(255, 255, 255, .5)',
    'rgba(0, 255, 255, .5)',
    'rgba(255, 0, 255, .5)',
    'rgba(0, 0, 229, .5)',
    'rgba(0, 255, 0, .5)',
  ]
  function Circle(x,y,dx,dy,radius,clr,ssty) {
   this.x = x;
   this.y = y;
   this.dx = dx;
   this.dy = dy;
   this.radius = radius;
   //this.id= id;
   this.clr=clr;
   this.ssty=ssty;

  console.log("xy",x,y);
  //draw





  };
  Circle.prototype.clicked = function(){

    console.log('hmmm')
  };
  Circle.prototype.draw = function(){

    c.beginPath();
    c.arc(this.x, this.y, this.radius, 0, 2 * Math.PI,false);
    c.strokeStyle = this.ssty;
      c.fillStyle = this.clr;
      c.fill();
          c.stroke();

    //c.addHitRegion({ida: 'circle'});




// c.strokeStyle = this.ssty;
//   c.font = "50px arial ";
//
//
//   c.fillText(`${this.id}`, this.x , this.y,this.radius);

    // console.log("circle drawn");


  };
  Circle.prototype.update = function(){
    if (this.x + this.radius > cW ||this.x - this.radius < 0) {
        this.dx= -this.dx;
    }
     if (this.y + this.radius > cH ||this.y - this.radius < 0) {
          this.dy= -this.dy;
        }

    this.x += this.dx;
    this.y += this.dy;

    this.draw();

  };

  //touch detection
  Circle.prototype.isHitBy= function(x,y){
    //a**+b**=c**
    /*
  square root of (mousex -positionX squared) +( mouseY - positionY squared )
    */
  let distance =Math.sqrt(Math.pow(x- this.x,2)+Math.pow(y - this.y,2));
  return distance < this.radius;
  };

  var circleArray = [] ;

  function babies ()
  {
    for (var i = 0; i < 5; i++) {
      let radius = 50;
      let x= Math.random() *(canvas.width - radius*2)+ radius;
      let y = Math.random() *(canvas.height - radius*2)+ radius;
      let dx = Math.random() * -0.5 *2;
      let dy = Math.random() * -0.5 *4;
      let clr = colorArray[Math.floor(Math.random()* colorArray.length)];
      let ssty= colorArray[Math.floor(Math.random()* colorArray.length)];
    var numText = '?' ;
    var circle =new Circle(x,y,dx,dy,radius,clr,ssty);
    //  var circle = new Circle(200,200,3,4,40);
      circleArray.push( circle);

    }
  }

  ///event mouse down deletes the circle



    var clickling = (e)=>{
      e.preventDefault();
      let mX=( e.clientX- c.canvas.offsetLeft)  ;
      let mY= (e.clientY- c.canvas.offsetTop)  ;
      sound.src = 'blop.mp3'
      sound.play()
      let canvasBounds = canvas.getBoundingClientRect();
      let clickX = e.pageX- canvasBounds.left;
      let clickY = e.pageY- canvasBounds.top;
      sound.src = 'blop.mp3'
      for (var i = 0; i < circleArray.length; i++) {

      if(circleArray[i].isHitBy(clickX,clickY)){

        console.log("resasre",i);


        let  target=circleArray[i];
        target.clr=colorArray[Math.floor(Math.random()* colorArray.length)];

        sound.play()
        target.radius += 10;
        let n=i;
        console.log (`${n}  ${i}`)
      setTimeout(function(){circleArray.splice(n,1)}, 100);

    if(score<500){
     score += 25;
     document.getElementById('status').innerHTML = `Score: ${score}`
        //target.radius=0;
      }else {
        score = 5;
        document.getElementById('status').innerHTML = `Score: ${score}`
      } ///target.pop();

      setTimeout(function(){
        if (circleArray === undefined || circleArray.length == 0) {
          babies();
          console.log('BABIES!!!!!1');
      }else {console.log('No babies :(');}
    }, 500);

      }
    }
    };

    canvas.addEventListener('mousedown', clickling);
    canvas.addEventListener('touch', clickling);
canvas.addEventListener('touchmove', clickling);
//canvas.addEventListener('touchstart', clickling);

  //animates the circle
//let clrr =colorArray[Math.floor(Math.random()* colorArray.length)];
  function animate () {

      requestAnimationFrame(animate);
      c.clearRect(0,0,innerWidth, innerHeight);
      c.fillStyle = 'rgba(10,010,10,1)';
      c.fillRect(0,0,innerWidth, innerHeight);



      for (var i = 0; i < circleArray.length; i++) {

        circleArray[i].update();
        //console.log(circleArray[1].x)
      }


  }


  animate();

  console.log(circleArray)

babies();
  </script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My HTML Page</title>
  <link rel="stylesheet" type="text/css" title="Cool stylesheet" href="style.css">
</head>
<body>
  <div id="root"></div>
  <script src="main.js" type="text/javascript"></script>
</body>
</html>
